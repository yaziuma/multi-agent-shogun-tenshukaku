{% extends "base.html" %}

{% block content %}
<div class="container">
    <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <nav class="tab-nav">
        <button class="tab-btn active" data-tab="command">æŒ‡æ®</button>
        <button class="tab-btn" data-tab="dashboard">æˆ¦æ³</button>
        <button class="tab-btn" data-tab="history">å±¥æ­´</button>
    </nav>

    <!-- ã‚¿ãƒ–1: æŒ‡æ® -->
    <div class="tab-content active" id="tab-command">
        <section class="command-input">
            <h2>ğŸ“ æŒ‡ç¤ºå…¥åŠ›</h2>
            <form hx-post="/api/command" hx-target="#command-result" hx-swap="innerHTML">
                <textarea name="instruction" rows="5" placeholder="å®¶è€ã¸ã®æŒ‡ç¤ºã‚’å…¥åŠ›..."></textarea>
                <button type="submit">é€ä¿¡</button>
            </form>
            <div id="command-result"></div>
        </section>

        <section class="realtime-output" hx-ext="ws" ws-connect="/ws">
            <h2>ğŸ”„ å®¶è€ãƒšã‚¤ãƒ³å‡ºåŠ›</h2>
            <div id="karo-output" class="terminal"></div>
        </section>
    </div>

    <!-- ã‚¿ãƒ–2: æˆ¦æ³ -->
    <div class="tab-content" id="tab-dashboard">
        <section class="dashboard">
            <h2>ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>
            <div hx-get="/api/dashboard" hx-trigger="load, every 5s" hx-swap="innerHTML">
                Loading...
            </div>
        </section>
    </div>

    <!-- ã‚¿ãƒ–3: å±¥æ­´ -->
    <div class="tab-content" id="tab-history">
        <section class="command-history">
            <h2>ğŸ“œ ã‚³ãƒãƒ³ãƒ‰å±¥æ­´</h2>
            {% include "partials/history.html" %}
        </section>
    </div>
</div>

<script>
document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById('tab-' + btn.dataset.tab).classList.add('active');
    });
});
</script>
{% endblock %}
